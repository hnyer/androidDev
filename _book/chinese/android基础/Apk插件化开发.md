# Apk插件化开发
## 插件化开发是什么
```text
把一个完整的App拆分成宿主和插件两大部分，
宿主就是先运行的app，插件即宿主运行时加载的apk文件，
这样宿主和插件结合的方案技术就是插件化。
```


## 模块化 、 组件化 、模块化 概念
```text
模块化是一个较大的概念 ，
指分拆代码，即当我们的代码特别臃肿的时候，用模块化将代码分而治之、解耦分层。

组件化
将一个工程拆成多个模块，每个组件是一个 lib ，
lib 之间没有直接依赖关系，用功能接口方式进行交互。
每个组件可以独立当做App存在。
可以参考后端开发的 “微服务”概念。

插件化
将一个工程拆成一个宿主 和多个 插件，
每个插件是一个可以独立运行的 apk ，
宿主可以主动调用打开 插件。

组件化侧重功能独立、没有依赖关系，可以作为独立的组建对外提供功能。不存在兼容性。
插件化侧重于动态调用、体现在“插”字，插入某个功能，用完就拔走再插入另外一个功能，
因为插件化不可避免的去 hook 一些系统的 api，也就不可避免地有兼容性的问题，
而且Android系统版本更新对插件化方案的影响很大。
因此每个插件化方案需要有专门的团队去负责维护；
```



## 插件化开发的优点
```text
1、解耦。
独立各大模块的业务成为插件，互不干扰，即用即插，方便开发与维护。

2、加快编译。
每次修改后无需重新编辑整个工程项目，
可以单独编译某个插件工程，对于庞大的项目而言可以节约大量编译时间。

3、动态更新。
无需重新下载与安装app ，可以单独下载某个插件apk， 从动态更新、包体积和流量上感觉是个不错的选择。

4、模块定制。
需要什么模块下载什么模块，无需让app变得庞大。
```



## 插件化缺点
```text
插件化已经是一个过去式了，
Google从@hide开始就已经表明决心要干掉这些所谓“插件化”的不法分子了，
和google对着干没意义，需要投入大量精力，
采用田维术先生的一句话：“2018年Android 9.0上私有API的限制几乎称得上是盖棺定论了
——曾经波澜壮阔的插件化进程必将要退出历史主流”。

从Android Jetpack可以看出Google规范开行为的用意。

滴滴开源的 VirtualAPK 已经于 2018年 停止更新。
Android每次版本升级都会给各个插件化框架带来不少冲击，
所以不再更新的框架在新系统上会存在兼容等问题。

googleplay 已经不允许动态更新类的插件化，
所以插件化已经慢慢退出历史舞台。
```


## 第三方插件化开发 框架
### VirtualAPK (滴滴 )
```text
2018年 停止更新。
```

### RePlugin (360)
```text
更新缓慢，不支持最新 Gradle ,
不支持 androidx 。
```

### atlas (阿里巴巴)
```text
更新缓慢，不兼容最新版本。
```


### DynamicAPK (携程)
```text
2015 停止更新 。
```


## 插件化开发原理
```text
利用 hook 一些系统的 api 等。
技术已经废弃，不深入研究。
```