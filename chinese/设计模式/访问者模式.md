# 访问者模式  Visitor Pattern

访问者模式把  数据结构 和 作用于结构上的操作 解耦合 。适用于数据结构相对稳定算法又易变化的场景。


#### [示例](https://blog.csdn.net/lovelion/article/details/7433576)
以公司员工和部门的关系为场景。
```java
/**全职员工*/
public class FulltimeEmployee implements Employee  {

    public FulltimeEmployee(String name, int workTime) {...}

    /**每个对象都会实现这个方法*/
    @Override
    public void accept(Department handler) {
        //每个访问者都会有这个方法
        handler.visit(this);
    }
}


/**人力资源部类：具体访问者类*/
public class HRDepartment implements Department {
    /**所有访问者都会重载 所有 visit方法*/
    @Override
    public void visit(FulltimeEmployee employee) {  ... }

    /***所有访问者都会重载 所有 visit方法 */
    @Override
    public void visit(ParttimeEmployee employee) { ...  }
}


//使用。访问者不同，会做出不同的处理结果
Employee  employee = new FulltimeEmployee(...);
Department dep = new HRDepartment(....) ;
//Department dep = new FADepartment (....) ;
employee.accept(dep);
```

#### 优点
1、方便定义 新的访问者，实现新的数据操作。
```java
//Department dep = new HRDepartment(....) ;
//定义新的访问者
Department dep = new FADepartment (....) ;
```

#### 缺点
1、违背了"依赖倒置原则" 。访问者依赖的是具体元素，而不是抽象元素。
```java
 public void visit(FulltimeEmployee employee) {  ... }
```

2、增加新的元素类比较困难。<br>
每增加一个元素类 , 访问者就要多加一个visit()。
```java
// 有 n个元素类 就有 n 个visit 方法
@Override
public void visit(FulltimeEmployee employee) {  ... }
....
@Override
public void visit(ParttimeEmployee employee) { ...  }
```

&nbsp;&nbsp;

### 访问者模式 和 策略模式 的区别
我个人感觉这两个模式差不多。 个人体会到的区别：  <br>
1、策略模式是通过构造方法将策略传进去的 。 访问者模式 是通过普通的方法 accept() 将访问者（策略）传进的。<br>
2、 体现在定义架构上
```java
public class HRDepartment implements Department {
    @Override
    public void visit(FulltimeEmployee employee) {  ... }
    ...
    @Override
    public void visit(ParttimeEmployee employee) { ...  }
}
```
