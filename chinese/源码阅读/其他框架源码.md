# LeakCanary
```text
https://square.github.io/leakcanary/
https://github.com/square/leakcanary

LeakCanary 目前最新的版本是 Version 2.7 (2021-03-26)，
相比之前的版本，2.0 之后的版本在使用上简洁了很多，
只需要在 dependencies 中加入 LeakCanary 的依赖即可。
而且 debugImplementation 只在 debug 模式下有效，
所以不用担心用户在正式环境下也会出现 LeakCanary 收集。

dependencies {
  debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.7'
}
```

## leakCanary 基本原理
```text
LeakCanary 的基础是一个叫做 ObjectWatcher Android 的库。
它 hook 了 Android 的生命周期，当 activity 和 fragment 被销毁并且应该被垃圾回收时候自动检测。
这些被销毁的对象被传递给 ObjectWatcher， 
ObjectWatcher 持有这些被销毁对象的弱引用 。
如果弱引用在等待5秒钟并运行垃圾收集器后仍未被清除，
那么被观察的对象就被认为是保留的（在生命周期结束后仍然保留），并存在潜在的泄漏。
LeakCanary会在 Logcat 中输出这些日志。
```

