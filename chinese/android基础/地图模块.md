# 地图模块

## 坐标类型
```text
//  世界标准地理坐标 、WGS-84 
国际标准，从国际标准GPS设备中获取到的坐标都是 WGS84 。
WGS－84 坐标系是美国建立的GSP原始坐标系；

// 中国国测局地理坐标 、 GCJ-02  、 火星坐标 
中国标准，国家测绘局 发布的坐标系 。在中国，必须至少使用GCJ02对地图进行首次加密。  

火星坐标系统 ，就是中国设计的一个加密插件，是对真实地图进行人为的加偏处理，按照一定的加偏算法，将真实的坐标加密成虚假的坐标。
加偏处理不是线性的加偏，所以各地的偏移情况都会有所不同。这样一来地图的坐标就与实地的坐标不相符了，于是大家把这种坐标戏称为"火星坐标" 。

// CGCS2000 坐标系
China Geodetic Coordinate System 2000 ,是我国建立的大地坐标系，类似于WGS－84坐标系，是原始坐标系。

// 搜狗坐标系
由GCJ-02进行进一步的偏移算法得到。

// 百度地理坐标 、 BD-09
百度标准， 在GCJ02 的基础上进行二次加密。
```

##  各个地图软甲采用的坐标系
```text
在中国，任何一个地图产品 至少使用GCJ-02进行首次加密，不允许直接使用WGS-84坐标下的地理数据，同时任何坐标系均不可转换为WGS-84坐标。

网上有人总结反推的一些转换接口，都是有偏差的。对精度非常严格的使用场景，要慎重使用。 
基于 GCJ-02 转 WGS-84 的转换结果都有偏差。
基于 WGS-84 转 GCJ-02 的转换结果没有偏差。

// 百度地图
1、境内、包括港澳台 :  BD09 。
2、境外 : WGS-84 。

// 高德地图:
1、境内：GCJ-02
2、境外：暂不支持

// 腾讯地图 
1、境内：GCJ-02
2、境外：暂不支持 

// google地图
1、境内：GCJ-02  , 数据来源于高德，两者互通。 
2、境外：WGS-84 。

// bing地图 ,微软的
全球统一：WGS-84 。Bing地图图源较老 。

// 天地图
全球统一 ：CGCS2000
```

## 地图坐标互相转换
https://github.com/hnyer/JZLocationConverter-for-Android


## 高德地图
### 根据指定经纬度显示和导航
```text
String.format(Locale.getDefault(), "https://m.amap.com/share/index/lnglat=%f,%f" ,  xx.longitude ,xx.latitude) ;
```

### 隐藏左下角Logo
```text
// 高德地图隐藏左下角Logo
UiSettings settings = aMap.getUiSettings();
settings.setLogoBottomMargin(-50);//高德logo图标无法移除 ，但是可以通过设置偏移的位置 来隐藏它  
```

### 地理围栏
```text
https://lbs.amap.com/api/android-location-sdk/guide/additional-func/local-geofence/
```

## 加载谷歌瓦片地图数据
http://mt0.google.cn/vt/lyrs=y&hl=en&gl=en&src=app&x=6678&y=3558&z=13&s=  // ok
http://mt0.google.cn/vt/lyrs=y&x=6678&y=3558&z=13  
http://mt0.google.cn/vt/lyrs=y@110&x=6678&y=3558&z=13  

```text
格式
http://mt0.google.cn/vt/lyrs={lyrs}&hl=en&gl=en&src=app&x=%d&y=%d&z=%d&s=
http://mt0.google.cn/vt/lyrs={lyrs}&x=%d&y=%d&z=%d   // 一般用这个就可以了，不需要很多其他参数

// 服务器地址 ，可选，效果都是一样的
http://mt0.google.cn
http://mt1.google.cn
http://mt2.google.cn
http://mt3.google.cn

// x 列号 、  y 行号  、 z  zoom级别
// hl :en 、 zh-CN 
// gl : en 、cn
// src : 标记来自哪里的请求？
// s : 作用未知，可用可不用。随便填 。

// lyrs 
m：路线图  
​t：地形图  
​s：卫星图 
​p：带标签的地形图  
​y：带标签的卫星图
​h：标签层（路名、地名等）

我看到其他有些后面跟了个@参数，暂时不知道什么作用。lyrs=m@167000000 。不用貌似也没有问题。
经过测试发现 谷歌中国，高德 都采用了 火星坐标系。不过谷歌中国同时也提供了 wgs84坐标系方式的地图，只要修改一个参数即可，
将gl=cn去掉，则下载的地图 就变成了 wgs84,否则 则是火星坐标系。
```

## 高德地图 加载 .mbtiles 文件
mbtiles 文件其实就是一个 sqllite 数据库文件。此处给出我写的一个demo。关键点在于 y 坐标的转换。
```text
https://gitee.com/Aivin_CodeShare/android_tool_code/raw/master/MbTilesDataTool.java

如果 高德要加载国外地图，需要 Mbtiles 是个有偏移过的 数据库。
如何编辑和生成 mbtiles 文件暂时没有研究。暂由客户自己提供。
```

## 加载英文地图
```text
自 Android 3D 地图SDK  V5.5.0起，地图支持切换中英文显示。
AMap.CHINESE 表示中文，即"zh_cn", AMap.ENGLISH 表示英文，即"en" 
aMap.setMapLanguage(AMap.ENGLISH);   
```

## 其他
### 禁飞区

```text
大疆禁飞区查询
https://www.dji.com/cn/flysafe/geo-map

优凯限飞区查询与下载
http://xianfei.u-care.net.cn/#/downLoad 


在线导入kml查看效果图
http://geojson.io/#map=2/20.0/0.0

Java主要用dom4j包解析kml文件。 
```


## 地球在线
https://www.earthol.com/
```text
全球高清卫星地图、
可以根据具体经纬度定位到地点。
```

 
